{% extends "base.html" %}

{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/editor.css') }}">
{% endblock %}

{% block content %}
<div class="editor-container">
    <div class="editor-header">
        <input type="text" id="quiz-name" placeholder="Quiz Name">
        <div class="editor-actions">
            <span id="save-status" style="margin-right: 1rem; font-size: 0.9rem;">Saved</span>
            <button id="save-btn" class="btn">Save</button>
            <button id="back-btn" class="btn">Back</button>
            <button id="logout-btn" class="btn" style="background-color: #dc3545; color: white; margin-left: 0.5rem;">Logout</button>
        </div>
    </div>
    <div class="editor-main">
        <div class="editor-sidebar">
            <div class="sidebar-header">
                <div id="sidebar-zoom-controls"></div>
                <div class="sidebar-tabs">
                    <button class="sidebar-tab active" data-tab="elements">Elements</button>
                    <button class="sidebar-tab" data-tab="pages">Pages</button>
                </div>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-tab-content active" id="sidebar-tab-elements">
                    <div class="element-list">
                        <div class="element-item" data-type="media">Media</div>
                        <div class="element-item" data-type="richtext">Rich Text</div>
                        <div class="shapes-category">
                            <div class="shapes-header" id="shapes-header">
                                <span>Shapes</span>
                                <span class="shapes-arrow">▼</span>
                            </div>
                            <div class="shapes-menu" id="shapes-menu" style="display: none;">
                                <div class="shape-item" data-type="rectangle">Rectangle</div>
                                <div class="shape-item" data-type="circle">Circle</div>
                                <div class="shape-item" data-type="arrow">Arrow</div>
                                <div class="shape-item" data-type="line">Line</div>
                                <div class="shape-item" data-type="triangle">Triangle</div>
                                <div class="shape-item" data-type="plus">Plus</div>
                            </div>
                        </div>
                        <div class="shapes-category">
                            <div class="shapes-header" id="special-header">
                                <span>Special</span>
                                <span class="shapes-arrow">▼</span>
                            </div>
                            <div class="shapes-menu" id="special-menu" style="display: none;">
                                <div class="shape-item" data-type="counter">Counter</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sidebar-tab-content" id="sidebar-tab-pages">
                    <div id="pages-list"></div>
                    <button id="add-page-btn" class="btn btn-small">Add Page</button>
                    <button id="add-status-page-btn" class="btn btn-small">Add Status Page</button>
                    <button id="add-results-page-btn" class="btn btn-small">Add Results Page</button>
                </div>
            </div>
        </div>
        <div class="editor-canvas-container">
            <div class="canvas-tabs">
                <button class="canvas-tab active" data-view="display">Display</button>
                <button class="canvas-tab" data-view="participant">Participant</button>
                <button class="canvas-tab" data-view="control">Control</button>
            </div>
            <div class="canvas-scroll-area" id="general-canvas">
                <div id="displayable-area-wrapper">
                    <div id="displayable-area"></div>
                    <!-- Resize handles -->
                    <div class="resize-handle resize-handle-n" data-direction="n"></div>
                    <div class="resize-handle resize-handle-s" data-direction="s"></div>
                    <div class="resize-handle resize-handle-e" data-direction="e"></div>
                    <div class="resize-handle resize-handle-w" data-direction="w"></div>
                    <div class="resize-handle resize-handle-ne" data-direction="ne"></div>
                    <div class="resize-handle resize-handle-nw" data-direction="nw"></div>
                    <div class="resize-handle resize-handle-se" data-direction="se"></div>
                    <div class="resize-handle resize-handle-sw" data-direction="sw"></div>
                </div>
            </div>
        </div>
        <div class="properties-resize-handle"></div>
        <div class="editor-properties">
            <h3>Properties</h3>
            <div id="properties-panel"></div>
        </div>
    </div>
</div>

<!-- Media Selection Modal -->
<div id="media-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Select Media</h2>
            <button class="modal-close" id="media-modal-close">&times;</button>
        </div>
        <div class="modal-tabs">
            <button class="modal-tab active" data-tab="images">Images</button>
            <button class="modal-tab" data-tab="audio">Audio</button>
            <button class="modal-tab" data-tab="video">Video</button>
        </div>
        <div class="modal-search" style="padding: 1rem; border-bottom: 1px solid #ddd;">
            <input type="text" id="media-search-input" placeholder="Search media files..." style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9rem;">
        </div>
        <div class="modal-body">
            <div id="media-tab-images" class="modal-tab-content active">
                <div class="media-section">
                    <h3>My Media</h3>
                    <div id="my-images-list" class="media-list"></div>
                </div>
                <div class="media-section">
                    <h3>Public Media</h3>
                    <div id="public-images-list" class="media-list"></div>
                </div>
                <button class="btn btn-primary" id="upload-image-btn">Upload Image</button>
                <input type="file" id="upload-image-file" accept="image/*" style="display: none;" multiple>
            </div>
            <div id="media-tab-audio" class="modal-tab-content">
                <div class="media-section">
                    <h3>My Media</h3>
                    <div id="my-audio-list" class="media-list"></div>
                </div>
                <div class="media-section">
                    <h3>Public Media</h3>
                    <div id="public-audio-list" class="media-list"></div>
                </div>
                <button class="btn btn-primary" id="upload-audio-btn">Upload Audio</button>
                <input type="file" id="upload-audio-file" accept="audio/*" style="display: none;" multiple>
            </div>
            <div id="media-tab-video" class="modal-tab-content">
                <div class="media-section">
                    <h3>My Media</h3>
                    <div id="my-video-list" class="media-list"></div>
                </div>
                <div class="media-section">
                    <h3>Public Media</h3>
                    <div id="public-video-list" class="media-list"></div>
                </div>
                <button class="btn btn-primary" id="upload-video-btn">Upload Video</button>
                <input type="file" id="upload-video-file" accept="video/*" style="display: none;" multiple>
            </div>
        </div>
    </div>
</div>

<!-- Question type modules for editor preview -->
<script src="{{ url_for('static', filename='js/question-types/common.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/text/control_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/text/control_mockup.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/radio/control_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/radio/control_mockup.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/checkbox/control_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/checkbox/control_mockup.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/stopwatch/control_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/stopwatch/control_mockup.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/image_click/control_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/image_click/control_mockup.js') }}"></script>
<!-- Participant view modules for editor preview (used by answer_input elements) -->
<script src="{{ url_for('static', filename='js/question-types/text/participant_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/radio/participant_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/checkbox/participant_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/stopwatch/participant_view.js') }}"></script>
<script src="{{ url_for('static', filename='js/question-types/image_click/participant_view.js') }}"></script>
<!-- Background utilities (shared between editor and runtime) -->
<script src="{{ url_for('static', filename='js/background-utils.js') }}"></script>
<!-- Element type definitions -->
<script src="{{ url_for('static', filename='js/element-types.js') }}"></script>
<!-- Editor modules -->
<script src="{{ url_for('static', filename='js/editor/utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/quiz-structure.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/quiz-storage.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/page-manager.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/element-creator.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/media-modal.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/color-picker.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/background-modal.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/interaction-handlers.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/context-menu.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/copy-paste.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/appearance-control-renderer.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/element-renderer.js') }}"></script>
<!-- Editor modules -->
<script src="{{ url_for('static', filename='js/editor/zoom-controls.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/canvas-size-controls.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/element-selection.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/undo-redo.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/canvas-renderer.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/properties-panel.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/properties/page-properties.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/properties/general-properties.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/properties/counter-properties.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/properties/visibility-properties.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/properties/page-visibility-properties.js') }}"></script>
<script src="{{ url_for('static', filename='js/editor/properties/media-properties.js') }}"></script>
<!-- Main editor file -->
<script src="{{ url_for('static', filename='js/editor.js') }}"></script>
{% endblock %}

